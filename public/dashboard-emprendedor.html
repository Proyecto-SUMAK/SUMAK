<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Panel - SUMAK</title>
     
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="assets/images/SumakLogo_.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/images/SumakLogo_.png">
    <link rel="apple-touch-icon" sizes="180x180" href="assets/images/SumakLogo_.png">
    <link rel="shortcut icon" href="assets/images/SumakLogo_.png">
    
    <link rel="stylesheet" href="assets/styles/variables.css">
    <link rel="stylesheet" href="assets/styles/style.css">
    <link rel="stylesheet" href="assets/styles/responsive.css">
    <style>
        /* Estilos espec√≠ficos del dashboard */
        .dashboard {
            display: grid;
            grid-template-columns: 250px 1fr;
            min-height: 100vh;
            background-color: var(--color-background);
        }

        .sidebar {
            background-color: var(--color-surface);
            padding: var(--spacing-lg);
            border-right: 1px solid var(--color-border);
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
        }

        .sidebar__header {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-xl);
            padding-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--color-border);
        }

        .sidebar__logo {
            width: 40px;
            height: 40px;
        }

        .sidebar__brand {
            font-family: var(--font-family-primary);
            font-size: 1.5rem;
            font-weight: var(--font-weight-black);
            color: var(--color-primary);
        }

        .sidebar__nav {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xs);
        }

        .sidebar__link {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm);
            color: var(--color-text-secondary);
            border-radius: var(--border-radius-md);
            transition: all var(--transition-fast);
        }

        .sidebar__link:hover,
        .sidebar__link--active {
            background-color: var(--color-primary-lightest);
            color: var(--color-primary);
        }

        .sidebar__link svg {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
        }

        .main-content {
            padding: var(--spacing-xl);
            overflow-y: auto;
        }

        .dashboard-header {
            margin-bottom: var(--spacing-xl);
        }

        .dashboard-header__top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-md);
        }

        .dashboard-header__title {
            font-size: 2rem;
            margin-bottom: 0.25rem;
        }

        .dashboard-header__subtitle {
            color: var(--color-text-secondary);
        }

        .dashboard-header__actions {
            display: flex;
            gap: var(--spacing-sm);
            align-items: center;
        }

        .icon-button {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background-color: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius-full);
            cursor: pointer;
            transition: all var(--transition-fast);
            position: relative;
        }

        .icon-button:hover {
            background-color: var(--color-primary-lightest);
            border-color: var(--color-primary);
        }

        .icon-button__badge {
            position: absolute;
            top: -4px;
            right: -4px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 18px;
            height: 18px;
            padding: 0 4px;
            background-color: var(--color-error);
            color: white;
            font-size: 0.75rem;
            font-weight: var(--font-weight-semibold);
            border-radius: var(--border-radius-full);
        }

        .user-menu {
            position: relative;
        }

        .user-menu__toggle {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: 0.5rem 1rem;
            background-color: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius-full);
            cursor: pointer;
        }

        .user-menu__avatar {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            background-color: var(--color-primary);
            color: white;
            font-weight: var(--font-weight-semibold);
            border-radius: var(--border-radius-full);
        }

        .user-menu__dropdown {
            display: none;
            position: absolute;
            top: calc(100% + 0.5rem);
            right: 0;
            min-width: 200px;
            background-color: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius-md);
            box-shadow: var(--shadow-lg);
            z-index: var(--z-index-dropdown);
        }

        .user-menu__dropdown.is-open {
            display: block;
        }

        .user-menu__item {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm) var(--spacing-md);
            color: var(--color-text-primary);
            transition: background-color var(--transition-fast);
        }

        .user-menu__item:hover {
            background-color: var(--color-background);
        }

        .user-menu__item--danger {
            color: var(--color-error);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-xl);
        }

        .stat-card {
            padding: var(--spacing-lg);
            background-color: var(--color-surface);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-sm);
        }

        .stat-card__label {
            font-size: var(--font-size-small);
            color: var(--color-text-tertiary);
            margin-bottom: var(--spacing-xs);
        }

        .stat-card__value {
            font-family: var(--font-family-primary);
            font-size: 2rem;
            font-weight: var(--font-weight-black);
            color: var(--color-primary);
        }

        .stat-card__change {
            font-size: var(--font-size-small);
            color: var(--color-success);
            margin-top: var(--spacing-xs);
        }

        .progress-section {
            padding: var(--spacing-lg);
            background-color: var(--color-surface);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-sm);
            margin-bottom: var(--spacing-xl);
        }

        .progress-section__header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-md);
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background-color: var(--color-background);
            border-radius: var(--border-radius-full);
            overflow: hidden;
            margin-bottom: var(--spacing-sm);
        }

        .progress-bar__fill {
            height: 100%;
            background: linear-gradient(90deg, var(--color-primary) 0%, var(--color-primary-light) 100%);
            border-radius: var(--border-radius-full);
            transition: width 1s ease-out;
        }

        .tasks-section {
            margin-bottom: var(--spacing-xl);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-md);
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: var(--font-weight-bold);
        }

        .tasks-grid {
            display: grid;
            gap: var(--spacing-md);
        }

        .task-card {
            padding: var(--spacing-lg);
            background-color: var(--color-surface);
            border: 2px solid var(--color-border);
            border-radius: var(--border-radius-lg);
            transition: all var(--transition-normal);
        }

        .task-card:hover {
            border-color: var(--color-primary);
            box-shadow: var(--shadow-md);
        }

        .task-card__header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-sm);
        }

        .task-card__badge {
            padding: 0.25rem 0.75rem;
            font-size: var(--font-size-small);
            font-weight: var(--font-weight-semibold);
            border-radius: var(--border-radius-full);
        }

        .task-card__badge--alta {
            background-color: #FFEBEE;
            color: var(--color-error);
        }

        .task-card__badge--media {
            background-color: #FFF3E0;
            color: var(--color-warning);
        }

        .task-card__badge--baja {
            background-color: #E3F2FD;
            color: var(--color-info);
        }

        .task-card__category {
            font-size: var(--font-size-small);
            color: var(--color-text-tertiary);
            text-transform: uppercase;
        }

        .task-card__title {
            font-size: 1.125rem;
            margin-bottom: var(--spacing-sm);
        }

        .task-card__meta {
            display: flex;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            font-size: var(--font-size-small);
            color: var(--color-text-secondary);
        }

        .task-card__time,
        .task-card__difficulty {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .task-card__actions {
            display: flex;
            gap: var(--spacing-sm);
        }

        .empty-state {
            text-align: center;
            padding: var(--spacing-2xl);
            color: var(--color-text-secondary);
        }

        .empty-state svg {
            margin-bottom: var(--spacing-md);
            color: var(--color-text-tertiary);
        }

        .empty-state h3 {
            margin-bottom: var(--spacing-xs);
        }

        /* ========================================
           ESTILOS NUEVOS SPRINT 2
           ======================================== */

        /* US-002: Historial de microtareas */
        .history-section {
            margin-bottom: var(--spacing-xl);
        }

        .history-filters {
            display: flex;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-md);
            flex-wrap: wrap;
        }

        .history-filter {
            padding: 0.5rem 1rem;
            background-color: var(--color-surface);
            border: 2px solid var(--color-border);
            border-radius: var(--border-radius-full);
            cursor: pointer;
            transition: all var(--transition-fast);
            font-size: var(--font-size-small);
        }

        .history-filter:hover,
        .history-filter.active {
            background-color: var(--color-primary);
            color: white;
            border-color: var(--color-primary);
        }

        .history-list {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .history-item {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            padding: var(--spacing-md);
            background-color: var(--color-surface);
            border-radius: var(--border-radius-md);
            border-left: 4px solid var(--color-success);
        }

        .history-item__icon {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--color-success);
            color: white;
            border-radius: var(--border-radius-full);
            font-size: 1.25rem;
        }

        .history-item__content {
            flex: 1;
        }

        .history-item__title {
            font-weight: var(--font-weight-semibold);
            margin-bottom: 0.25rem;
        }

        .history-item__meta {
            font-size: var(--font-size-small);
            color: var(--color-text-tertiary);
        }

        .history-item__actions {
            display: flex;
            gap: var(--spacing-xs);
        }

        /* US-003: Compartir logros */
        .badges-section {
            margin-bottom: var(--spacing-xl);
        }

        .badges-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: var(--spacing-md);
        }

        .badge-card {
            padding: var(--spacing-lg);
            background-color: var(--color-surface);
            border-radius: var(--border-radius-lg);
            text-align: center;
            box-shadow: var(--shadow-sm);
            transition: all var(--transition-normal);
            cursor: pointer;
        }

        .badge-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }

        .badge-card__icon {
            font-size: 3rem;
            margin-bottom: var(--spacing-sm);
        }

        .badge-card__name {
            font-weight: var(--font-weight-semibold);
            margin-bottom: var(--spacing-xs);
        }

        .badge-card__date {
            font-size: var(--font-size-small);
            color: var(--color-text-tertiary);
        }

        .badge-card__share {
            margin-top: var(--spacing-sm);
            padding: 0.5rem 1rem;
            background-color: var(--color-primary-lightest);
            color: var(--color-primary);
            border: none;
            border-radius: var(--border-radius-full);
            cursor: pointer;
            font-size: var(--font-size-small);
            font-weight: var(--font-weight-medium);
            transition: all var(--transition-fast);
        }

        .badge-card__share:hover {
            background-color: var(--color-primary);
            color: white;
        }

        /* US-004: Modo audio */
        .audio-controls {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm);
            background-color: var(--color-background);
            border-radius: var(--border-radius-md);
            margin-top: var(--spacing-sm);
        }

        .audio-btn {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--color-primary);
            color: white;
            border: none;
            border-radius: var(--border-radius-full);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .audio-btn:hover {
            background-color: var(--color-primary-dark);
            transform: scale(1.05);
        }

        .audio-progress {
            flex: 1;
            height: 4px;
            background-color: var(--color-border);
            border-radius: var(--border-radius-full);
            overflow: hidden;
        }

        .audio-progress__fill {
            height: 100%;
            background-color: var(--color-primary);
            width: 0%;
            transition: width 0.1s linear;
        }

        .audio-time {
            font-size: var(--font-size-small);
            color: var(--color-text-tertiary);
            min-width: 80px;
            text-align: right;
        }

        /* US-007: Perfil p√∫blico */
        .profile-preview-card {
            padding: var(--spacing-xl);
            background: linear-gradient(135deg, var(--color-primary-lightest) 0%, var(--color-surface) 100%);
            border-radius: var(--border-radius-lg);
            margin-bottom: var(--spacing-xl);
            border: 2px solid var(--color-primary-light);
        }

        .profile-preview__header {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }

        .profile-preview__avatar {
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-light) 100%);
            color: white;
            font-size: 2rem;
            font-weight: var(--font-weight-bold);
            border-radius: var(--border-radius-full);
        }

        .profile-preview__info h3 {
            font-size: 1.5rem;
            margin-bottom: 0.25rem;
        }

        .profile-preview__badges {
            display: flex;
            gap: var(--spacing-xs);
            margin-top: var(--spacing-sm);
        }

        .profile-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.75rem;
            background-color: var(--color-primary);
            color: white;
            font-size: var(--font-size-small);
            border-radius: var(--border-radius-full);
        }

        .profile-preview__qr {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            padding: var(--spacing-md);
            background-color: var(--color-surface);
            border-radius: var(--border-radius-md);
            margin-top: var(--spacing-md);
        }

        .qr-code {
            width: 100px;
            height: 100px;
            background-color: white;
            padding: var(--spacing-xs);
            border-radius: var(--border-radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* US-023: Contactar mentor */
        .mentor-contact-card {
            padding: var(--spacing-lg);
            background-color: var(--color-surface);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-sm);
            margin-bottom: var(--spacing-xl);
        }

        .mentor-contact__header {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--color-border);
        }

        .mentor-avatar {
            width: 56px;
            height: 56px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--color-secondary) 0%, var(--color-secondary-light) 100%);
            color: white;
            font-size: 1.25rem;
            font-weight: var(--font-weight-bold);
            border-radius: var(--border-radius-full);
        }

        .mentor-info h4 {
            margin-bottom: 0.25rem;
        }

        .mentor-info p {
            font-size: var(--font-size-small);
            color: var(--color-text-tertiary);
        }

        .mentor-status {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: var(--font-size-small);
        }

        .mentor-status__dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .mentor-status__dot--online {
            background-color: var(--color-success);
        }

        .mentor-status__dot--offline {
            background-color: var(--color-text-tertiary);
        }

        .mentor-message-form {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .mentor-message-input {
            width: 100%;
            padding: var(--spacing-sm);
            border: 2px solid var(--color-border);
            border-radius: var(--border-radius-md);
            resize: vertical;
            min-height: 100px;
            font-family: inherit;
        }

        .mentor-message-input:focus {
            outline: none;
            border-color: var(--color-secondary);
        }

        .mentor-message-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .attach-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background-color: var(--color-background);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius-md);
            cursor: pointer;
            font-size: var(--font-size-small);
            transition: all var(--transition-fast);
        }

        .attach-btn:hover {
            border-color: var(--color-primary);
            background-color: var(--color-primary-lightest);
        }

        /* Modal estilos */
        .modal {
            display: none;
            position: fixed;
            inset: 0;
            z-index: var(--z-index-modal);
            align-items: center;
            justify-content: center;
        }

        .modal.modal--active {
            display: flex;
        }

        .modal__overlay {
            position: absolute;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.5);
        }

        .modal__container {
            position: relative;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            background-color: var(--color-surface);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-xl);
            overflow: hidden;
        }

        .modal__header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-lg);
            border-bottom: 1px solid var(--color-border);
        }

        .modal__title {
            font-size: 1.25rem;
            font-weight: var(--font-weight-semibold);
        }

        .modal__close {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--color-text-tertiary);
            transition: color var(--transition-fast);
        }

        .modal__close:hover {
            color: var(--color-text-primary);
        }

        .modal__body {
            padding: var(--spacing-lg);
            overflow-y: auto;
            max-height: calc(90vh - 140px);
        }

        .modal__footer {
            padding: var(--spacing-lg);
            border-top: 1px solid var(--color-border);
            display: flex;
            justify-content: flex-end;
            gap: var(--spacing-sm);
        }

        /* US-015: Upload con preview */
        .upload-area {
            padding: var(--spacing-xl);
            border: 2px dashed var(--color-border);
            border-radius: var(--border-radius-lg);
            text-align: center;
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .upload-area:hover,
        .upload-area.dragover {
            border-color: var(--color-primary);
            background-color: var(--color-primary-lightest);
        }

        .upload-area__icon {
            font-size: 3rem;
            margin-bottom: var(--spacing-sm);
        }

        .upload-preview {
            display: none;
            padding: var(--spacing-md);
            background-color: var(--color-background);
            border-radius: var(--border-radius-md);
            margin-top: var(--spacing-md);
        }

        .upload-preview.has-file {
            display: block;
        }

        .upload-preview__image {
            max-width: 100%;
            max-height: 200px;
            border-radius: var(--border-radius-md);
            margin-bottom: var(--spacing-sm);
        }

        .upload-preview__actions {
            display: flex;
            gap: var(--spacing-sm);
            justify-content: center;
        }

        /* Share Modal */
        .share-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--spacing-md);
        }

        .share-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-lg);
            background-color: var(--color-background);
            border-radius: var(--border-radius-md);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .share-option:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .share-option__icon {
            font-size: 2rem;
        }

        .share-option__label {
            font-weight: var(--font-weight-medium);
        }

        /* Tabs para navegaci√≥n interna */
        .dashboard-tabs {
            display: flex;
            gap: var(--spacing-xs);
            margin-bottom: var(--spacing-lg);
            border-bottom: 2px solid var(--color-border);
            padding-bottom: var(--spacing-sm);
        }

        .dashboard-tab {
            padding: var(--spacing-sm) var(--spacing-md);
            background: none;
            border: none;
            cursor: pointer;
            font-weight: var(--font-weight-medium);
            color: var(--color-text-tertiary);
            border-bottom: 2px solid transparent;
            margin-bottom: -calc(var(--spacing-sm) + 2px);
            transition: all var(--transition-fast);
        }

        .dashboard-tab:hover {
            color: var(--color-text-primary);
        }

        .dashboard-tab.active {
            color: var(--color-primary);
            border-bottom-color: var(--color-primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        @media (max-width: 767px) {
            .dashboard {
                grid-template-columns: 1fr;
            }

            .sidebar {
                display: none;
            }

            .main-content {
                padding: var(--spacing-md);
            }

            .dashboard-header__top {
                flex-direction: column;
                gap: var(--spacing-md);
                align-items: flex-start;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .task-card__actions {
                flex-direction: column;
            }

            .badges-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .share-options {
                grid-template-columns: 1fr;
            }
        }
    

    </style>
</head>
<body>
    <!-- 
        DASHBOARD DEL EMPRENDEDOR - SPRINT 2
        US-001: Recibir recordatorios de microtareas por WhatsApp
        US-002: Ver historial de microtareas completadas
        US-003: Compartir logros en redes sociales
        US-004: Modo solo audio para microlecciones
        US-007: Ver perfil p√∫blico de mi negocio
        US-014: Panel de progreso gamificado
        US-015: Subir evidencia con preview
        US-020: Recibir microtareas pr√°cticas y accionables
        US-022: Ver progreso y m√©tricas simples
        US-023: Contactar a mentor
    -->
    <div class="dashboard">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar__header">
                <img src="assets/images/SumakLogo_.png" alt="SUMAK" class="sidebar__logo">
                <span class="sidebar__brand">SUMAK</span>
            </div>

            <nav class="sidebar__nav">
                <a href="#" class="sidebar__link sidebar__link--active" data-tab="inicio">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/>
                    </svg>
                    <span>Inicio</span>
                </a>
                <a href="#" class="sidebar__link" data-tab="tareas">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 11l3 3L22 4"/>
                        <path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"/>
                    </svg>
                    <span>Mis Tareas</span>
                </a>
                <a href="#" class="sidebar__link" data-tab="historial">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <polyline points="12 6 12 12 16 14"/>
                    </svg>
                    <span>Historial</span>
                </a>
                <a href="#" class="sidebar__link" data-tab="logros">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                    </svg>
                    <span>Mis Logros</span>
                </a>
                <a href="#" class="sidebar__link" data-tab="perfil">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="8" r="5"/>
                        <path d="M20 21a8 8 0 10-16 0"/>
                    </svg>
                    <span>Mi Perfil P√∫blico</span>
                </a>
                <a href="#" class="sidebar__link" data-tab="mentor">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"/>
                    </svg>
                    <span>Mi Mentor</span>
                </a>
                <a href="recursos.html" class="sidebar__link">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M4 19.5A2.5 2.5 0 016.5 17H20"/>
                        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 014 19.5v-15A2.5 2.5 0 016.5 2z"/>
                    </svg>
                    <span>Recursos</span>
                </a>
                <a href="contacto.html" class="sidebar__link">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M9.09 9a3 3 0 015.83 1c0 2-3 3-3 3"/>
                        <line x1="12" y1="17" x2="12.01" y2="17"/>
                    </svg>
                    <span>Ayuda</span>
                </a>
            </nav>
        </aside>

        <!-- Contenido Principal -->
        <main class="main-content">
            <!-- Header del Dashboard -->
            <header class="dashboard-header">
                <div class="dashboard-header__top">
                    <div>
                        <h1 class="dashboard-header__title">
                            ¬°Hola, <span data-user-name>Usuario</span>! üëã
                        </h1>
                        <p class="dashboard-header__subtitle">
                            Bienvenido a tu panel de <span data-business-name>Negocio</span>
                        </p>
                    </div>

                    <div class="dashboard-header__actions">
                        <!-- Notificaciones -->
                        <div class="notifications">
                            <button class="icon-button" id="notifications-bell" aria-label="Notificaciones">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9"/>
                                    <path d="M13.73 21a2 2 0 01-3.46 0"/>
                                </svg>
                                <span class="icon-button__badge" id="notification-count">3</span>
                            </button>

                            <div class="user-menu__dropdown" id="notifications-panel">
                                <div id="notifications-list"></div>
                            </div>
                        </div>

                        <!-- Men√∫ de Usuario -->
                        <div class="user-menu">
                            <button class="user-menu__toggle" id="user-menu-toggle">
                                <div class="user-menu__avatar" data-user-avatar>U</div>
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="6 9 12 15 18 9"/>
                                </svg>
                            </button>

                            <div class="user-menu__dropdown" id="user-menu">
                                <a href="#" class="user-menu__item" data-tab="perfil">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="12" cy="8" r="5"/>
                                        <path d="M20 21a8 8 0 10-16 0"/>
                                    </svg>
                                    <span>Mi Perfil</span>
                                </a>
                                <a href="#" class="user-menu__item" id="config-btn">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="12" cy="12" r="3"/>
                                        <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"/>
                                    </svg>
                                    <span>Configuraci√≥n</span>
                                </a>
                                <a href="#" class="user-menu__item user-menu__item--danger" id="logout-btn">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"/>
                                        <polyline points="16 17 21 12 16 7"/>
                                        <line x1="21" y1="12" x2="9" y2="12"/>
                                    </svg>
                                    <span>Cerrar Sesi√≥n</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- TAB: INICIO -->
            <div class="tab-content active" id="tab-inicio">
                <!-- M√©tricas R√°pidas -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-card__label">Tareas Completadas</div>
                        <div class="stat-card__value" id="tasks-completed">0</div>
                        <div class="stat-card__change">+5 esta semana</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-card__label">Racha Actual</div>
                        <div class="stat-card__value" id="current-streak">0</div>
                        <div class="stat-card__change">¬°Sigue as√≠!</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-card__label">Insignias Ganadas</div>
                        <div class="stat-card__value" id="total-badges">0</div>
                        <div class="stat-card__change">3 m√°s para nuevo nivel</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-card__label">Actividad Semanal</div>
                        <div class="stat-card__value" id="weekly-activity">0%</div>
                        <div class="stat-card__change">Excelente progreso</div>
                    </div>
                </div>

                <!-- Progreso General -->
                <section class="progress-section">
                    <div class="progress-section__header">
                        <h2>Tu Progreso de Aprendizaje</h2>
                        <span id="progress-text">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-bar__fill" id="progress-bar" style="width: 0%"></div>
                    </div>
                    <p style="color: var(--color-text-secondary); font-size: var(--font-size-small); margin-top: var(--spacing-xs);">
                        Has completado <strong id="completed-count">0</strong> de <strong id="total-count">0</strong> microtareas en tu ruta personalizada
                    </p>
                </section>

                <!-- Tareas Pendientes -->
                <section class="tasks-section">
                    <div class="section-header">
                        <h2 class="section-title">Tus Microtareas</h2>
                        <a href="#" class="btn btn--outline btn--small" data-tab="tareas">Ver todas</a>
                    </div>

                    <div class="tasks-grid" id="tasks-list">
                        <!-- Las tareas se cargar√°n din√°micamente -->
                    </div>
                </section>

                <!-- Contactar Mentor (US-023) -->
                <section class="mentor-contact-card">
                    <div class="mentor-contact__header">
                        <div class="mentor-avatar">MG</div>
                        <div class="mentor-info">
                            <h4>Mar√≠a Garc√≠a</h4>
                            <p>Tu mentora asignada ‚Ä¢ Especialista en finanzas</p>
                        </div>
                        <div class="mentor-status">
                            <span class="mentor-status__dot mentor-status__dot--online"></span>
                            <span>Disponible</span>
                        </div>
                    </div>
                    <div class="mentor-message-form">
                        <textarea class="mentor-message-input" id="mentor-message" placeholder="Escribe tu pregunta o consulta aqu√≠..."></textarea>
                        <div class="mentor-message-actions">
                            <button class="attach-btn" id="attach-evidence-btn">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21.44 11.05l-9.19 9.19a6 6 0 01-8.49-8.49l9.19-9.19a4 4 0 015.66 5.66l-9.2 9.19a2 2 0 01-2.83-2.83l8.49-8.48"/>
                                </svg>
                                Adjuntar evidencia
                            </button>
                            <button class="btn btn--primary" id="send-mentor-message">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="22" y1="2" x2="11" y2="13"/>
                                    <polygon points="22 2 15 22 11 13 2 9 22 2"/>
                                </svg>
                                Enviar mensaje
                            </button>
                        </div>
                    </div>
                </section>
            </div>

            <!-- TAB: TAREAS -->
            <div class="tab-content" id="tab-tareas">
                <section class="tasks-section">
                    <div class="section-header">
                        <h2 class="section-title">Todas tus Microtareas</h2>
                    </div>
                    <div class="tasks-grid" id="all-tasks-list">
                        <!-- Las tareas se cargar√°n din√°micamente -->
                    </div>
                </section>
            </div>

            <!-- TAB: HISTORIAL (US-002) -->
            <div class="tab-content" id="tab-historial">
                <section class="history-section">
                    <div class="section-header">
                        <h2 class="section-title">Historial de Tareas Completadas</h2>
                    </div>
                    
                    <div class="history-filters">
                        <button class="history-filter active" data-filter="all">Todas</button>
                        <button class="history-filter" data-filter="finanzas">üí∞ Finanzas</button>
                        <button class="history-filter" data-filter="marketing">üì± Marketing</button>
                        <button class="history-filter" data-filter="ventas">üõçÔ∏è Ventas</button>
                        <button class="history-filter" data-filter="operaciones">‚öôÔ∏è Operaciones</button>
                    </div>

                    <div class="history-list" id="history-list">
                        <!-- El historial se cargar√° din√°micamente -->
                    </div>
                </section>
            </div>

            <!-- TAB: LOGROS (US-003) -->
            <div class="tab-content" id="tab-logros">
                <section class="badges-section">
                    <div class="section-header">
                        <h2 class="section-title">Tus Insignias y Logros</h2>
                        <span class="badge badge--primary">5 insignias ganadas</span>
                    </div>

                    <div class="badges-grid" id="badges-grid">
                        <!-- Las insignias se cargar√°n din√°micamente -->
                    </div>
                </section>
            </div>

            <!-- TAB: PERFIL P√öBLICO (US-007) -->
            <div class="tab-content" id="tab-perfil">
                <section class="profile-preview-card">
                    <div class="section-header">
                        <h2 class="section-title">Vista Previa de tu Perfil P√∫blico</h2>
                        <button class="btn btn--primary" id="edit-profile-btn">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/>
                                <path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/>
                            </svg>
                            Editar Perfil
                        </button>
                    </div>

                    <div class="profile-preview__header">
                        <div class="profile-preview__avatar" data-user-avatar>U</div>
                        <div class="profile-preview__info">
                            <h3 data-business-name>Mi Negocio</h3>
                            <p style="color: var(--color-text-secondary);" data-business-category>Categor√≠a del negocio</p>
                            <div class="profile-preview__badges">
                                <span class="profile-badge">
                                    <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M22 11.08V12a10 10 0 11-5.93-9.14"/>
                                        <polyline points="22 4 12 14.01 9 11.01" fill="none" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    Certificado SUMAK
                                </span>
                                <span class="profile-badge" style="background-color: var(--color-secondary);">
                                    ‚≠ê 4.8 valoraci√≥n
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="profile-preview__qr">
                        <div class="qr-code" id="qr-code">
                            <svg width="80" height="80" viewBox="0 0 100 100">
                                <rect x="0" y="0" width="100" height="100" fill="white"/>
                                <rect x="10" y="10" width="25" height="25" fill="black"/>
                                <rect x="65" y="10" width="25" height="25" fill="black"/>
                                <rect x="10" y="65" width="25" height="25" fill="black"/>
                                <rect x="40" y="40" width="20" height="20" fill="black"/>
                                <rect x="15" y="15" width="15" height="15" fill="white"/>
                                <rect x="70" y="15" width="15" height="15" fill="white"/>
                                <rect x="15" y="70" width="15" height="15" fill="white"/>
                                <rect x="18" y="18" width="9" height="9" fill="black"/>
                                <rect x="73" y="18" width="9" height="9" fill="black"/>
                                <rect x="18" y="73" width="9" height="9" fill="black"/>
                            </svg>
                        </div>
                        <div>
                            <h4>Comparte tu perfil</h4>
                            <p style="font-size: var(--font-size-small); color: var(--color-text-secondary); margin-bottom: var(--spacing-sm);">
                                Tus clientes pueden escanearlo para ver tu perfil
                            </p>
                            <div style="display: flex; gap: var(--spacing-xs);">
                                <button class="btn btn--outline btn--small" id="download-qr-btn">
                                    Descargar QR
                                </button>
                                <button class="btn btn--primary btn--small" id="share-profile-btn">
                                    Compartir enlace
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- TAB: MENTOR -->
            <div class="tab-content" id="tab-mentor">
                <section class="mentor-contact-card" style="margin-bottom: 0;">
                    <div class="mentor-contact__header">
                        <div class="mentor-avatar">MG</div>
                        <div class="mentor-info">
                            <h4>Mar√≠a Garc√≠a</h4>
                            <p>Tu mentora asignada ‚Ä¢ Especialista en finanzas</p>
                        </div>
                        <div class="mentor-status">
                            <span class="mentor-status__dot mentor-status__dot--online"></span>
                            <span>Disponible</span>
                        </div>
                    </div>
                    
                    <div style="padding: var(--spacing-md); background-color: var(--color-background); border-radius: var(--border-radius-md); margin-bottom: var(--spacing-md);">
                        <p style="font-size: var(--font-size-small); color: var(--color-text-secondary);">
                            <strong>Horarios de atenci√≥n:</strong> Lunes a Viernes, 9:00 AM - 6:00 PM
                        </p>
                        <p style="font-size: var(--font-size-small); color: var(--color-text-secondary);">
                            <strong>Tiempo estimado de respuesta:</strong> 2-4 horas
                        </p>
                    </div>

                    <div class="mentor-message-form">
                        <textarea class="mentor-message-input" id="mentor-message-full" placeholder="Escribe tu pregunta o consulta aqu√≠... Incluye todos los detalles relevantes para que tu mentor pueda ayudarte mejor."></textarea>
                        <div class="mentor-message-actions">
                            <button class="attach-btn" id="attach-evidence-btn-full">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21.44 11.05l-9.19 9.19a6 6 0 01-8.49-8.49l9.19-9.19a4 4 0 015.66 5.66l-9.2 9.19a2 2 0 01-2.83-2.83l8.49-8.48"/>
                                </svg>
                                Adjuntar evidencia
                            </button>
                            <button class="btn btn--primary" id="send-mentor-message-full">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="22" y1="2" x2="11" y2="13"/>
                                    <polygon points="22 2 15 22 11 13 2 9 22 2"/>
                                </svg>
                                Enviar mensaje
                            </button>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Modal: Compartir Logro (US-003) -->
    <div class="modal" id="share-badge-modal">
        <div class="modal__overlay"></div>
        <div class="modal__container">
            <div class="modal__header">
                <h2 class="modal__title">Compartir Insignia</h2>
                <button class="modal__close" onclick="closeShareModal()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal__body">
                <div style="text-align: center; margin-bottom: var(--spacing-lg);">
                    <div id="share-badge-icon" style="font-size: 4rem; margin-bottom: var(--spacing-sm);"></div>
                    <h3 id="share-badge-name"></h3>
                    <p style="color: var(--color-text-secondary);" id="share-badge-desc"></p>
                </div>
                
                <h4 style="margin-bottom: var(--spacing-md);">Comparte en:</h4>
                <div class="share-options">
                    <div class="share-option" onclick="shareToFacebook()">
                        <span class="share-option__icon">üìò</span>
                        <span class="share-option__label">Facebook</span>
                    </div>
                    <div class="share-option" onclick="shareToInstagram()">
                        <span class="share-option__icon">üì∏</span>
                        <span class="share-option__label">Instagram</span>
                    </div>
                    <div class="share-option" onclick="shareToWhatsApp()">
                        <span class="share-option__icon">üí¨</span>
                        <span class="share-option__label">WhatsApp</span>
                    </div>
                    <div class="share-option" onclick="downloadBadgeImage()">
                        <span class="share-option__icon">üì•</span>
                        <span class="share-option__label">Descargar imagen</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Subir Evidencia (US-015) -->
    <div class="modal" id="upload-evidence-modal">
        <div class="modal__overlay"></div>
        <div class="modal__container">
            <div class="modal__header">
                <h2 class="modal__title">Subir Evidencia</h2>
                <button class="modal__close" onclick="closeUploadModal()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal__body">
                <div class="upload-area" id="upload-area">
                    <div class="upload-area__icon">üìÅ</div>
                    <p><strong>Haz clic o arrastra</strong> tu archivo aqu√≠</p>
                    <p style="font-size: var(--font-size-small); color: var(--color-text-tertiary);">
                        Formatos soportados: JPG, PNG, PDF, MP4 (m√°x. 10MB)
                    </p>
                    <input type="file" id="evidence-file-input" hidden accept="image/*,video/*,.pdf">
                </div>

                <div class="upload-preview" id="upload-preview">
                    <img class="upload-preview__image" id="preview-image" src="" alt="Vista previa">
                    <div class="upload-preview__actions">
                        <button class="btn btn--outline btn--small" onclick="replaceFile()">
                            Reemplazar
                        </button>
                        <button class="btn btn--primary btn--small" onclick="confirmUpload()">
                            Confirmar
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Ver Tarea con Audio (US-004) -->
    <div class="modal" id="task-detail-modal">
        <div class="modal__overlay"></div>
        <div class="modal__container" style="max-width: 700px;">
            <div class="modal__header">
                <h2 class="modal__title" id="task-detail-title">Detalle de Tarea</h2>
                <button class="modal__close" onclick="closeTaskDetailModal()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal__body">
                <div id="task-detail-content"></div>
                
                <!-- Modo Audio (US-004) -->
                <div class="audio-controls" id="audio-controls">
                    <button class="audio-btn" id="audio-play-btn" onclick="toggleAudio()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <polygon points="5 3 19 12 5 21 5 3"/>
                        </svg>
                    </button>
                    <div class="audio-progress">
                        <div class="audio-progress__fill" id="audio-progress-fill"></div>
                    </div>
                    <span class="audio-time" id="audio-time">0:00 / 2:30</span>
                </div>
            </div>
            <div class="modal__footer">
                <button class="btn btn--outline" onclick="closeTaskDetailModal()">Cerrar</button>
                <button class="btn btn--primary" onclick="openUploadModal()">Subir Evidencia</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="assets/scripts/utils.js"></script>
    <script src="assets/scripts/dashboard.js"></script>
    <script>
        // ========================================
        // FUNCIONALIDADES SPRINT 2
        // ========================================

        document.addEventListener('DOMContentLoaded', () => {
            initTabs();
            initSidebarNavigation();
            loadBadges();
            loadHistory();
            initUploadArea();
            initAudioPlayer();
        });

        // ========================================
        // NAVEGACI√ìN POR TABS
        // ========================================

        function initTabs() {
            const tabLinks = document.querySelectorAll('[data-tab]');
            tabLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const tabId = link.dataset.tab;
                    switchTab(tabId);
                });
            });
        }

        function initSidebarNavigation() {
            const sidebarLinks = document.querySelectorAll('.sidebar__link[data-tab]');
            sidebarLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const tabId = link.dataset.tab;
                    
                    // Actualizar links activos
                    sidebarLinks.forEach(l => l.classList.remove('sidebar__link--active'));
                    link.classList.add('sidebar__link--active');
                    
                    switchTab(tabId);
                });
            });
        }

        function switchTab(tabId) {
            // Ocultar todas las tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Mostrar la tab seleccionada
            const targetTab = document.getElementById('tab-' + tabId);
            if (targetTab) {
                targetTab.classList.add('active');
            }
        }

        // ========================================
        // US-002: HISTORIAL DE TAREAS
        // ========================================

        function loadHistory() {
            const historyList = document.getElementById('history-list');
            if (!historyList) return;

            const completedTasks = [
                { id: 1, title: 'Registrar ventas del d√≠a', category: 'finanzas', completedAt: '2024-01-15', evidence: true },
                { id: 2, title: 'Publicar en redes sociales', category: 'marketing', completedAt: '2024-01-14', evidence: true },
                { id: 3, title: 'Calcular costos del producto', category: 'finanzas', completedAt: '2024-01-13', evidence: true },
                { id: 4, title: 'Atender cliente nuevo', category: 'ventas', completedAt: '2024-01-12', evidence: false },
                { id: 5, title: 'Organizar inventario', category: 'operaciones', completedAt: '2024-01-11', evidence: true }
            ];

            renderHistory(completedTasks);
            initHistoryFilters(completedTasks);
        }

        function renderHistory(tasks) {
            const historyList = document.getElementById('history-list');
            
            if (tasks.length === 0) {
                historyList.innerHTML = `
                    <div class="empty-state">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/>
                            <path d="M8 14s1.5 2 4 2 4-2 4-2"/>
                            <line x1="9" y1="9" x2="9.01" y2="9"/>
                            <line x1="15" y1="9" x2="15.01" y2="9"/>
                        </svg>
                        <h3>¬°A√∫n no tienes tareas completadas!</h3>
                        <p>Completa tu primera microtarea para empezar a construir tu historial</p>
                        <button class="btn btn--primary" data-tab="tareas">Ver mis tareas</button>
                    </div>
                `;
                return;
            }

            historyList.innerHTML = tasks.map(task => `
                <div class="history-item" data-category="${task.category}">
                    <div class="history-item__icon">‚úÖ</div>
                    <div class="history-item__content">
                        <div class="history-item__title">${task.title}</div>
                        <div class="history-item__meta">
                            ${getCategoryLabel(task.category)} ‚Ä¢ Completada el ${formatDate(task.completedAt)}
                            ${task.evidence ? ' ‚Ä¢ üìé Con evidencia' : ''}
                        </div>
                    </div>
                    <div class="history-item__actions">
                        <button class="btn btn--outline btn--small" onclick="viewHistoryDetail(${task.id})">
                            Ver detalle
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function initHistoryFilters(allTasks) {
            const filters = document.querySelectorAll('.history-filter');
            filters.forEach(filter => {
                filter.addEventListener('click', () => {
                    filters.forEach(f => f.classList.remove('active'));
                    filter.classList.add('active');
                    
                    const category = filter.dataset.filter;
                    if (category === 'all') {
                        renderHistory(allTasks);
                    } else {
                        const filtered = allTasks.filter(t => t.category === category);
                        renderHistory(filtered);
                    }
                });
            });
        }

        function viewHistoryDetail(taskId) {
            showToast('Cargando detalle de la tarea...', 'info');
        }

        // ========================================
        // US-003: INSIGNIAS Y COMPARTIR
        // ========================================

        function loadBadges() {
            const badgesGrid = document.getElementById('badges-grid');
            if (!badgesGrid) return;

            const badges = [
                { id: 1, name: 'Primera Venta', icon: 'üèÜ', date: '2024-01-10', description: 'Completaste tu primera tarea de ventas' },
                { id: 2, name: 'Constancia', icon: 'üî•', date: '2024-01-12', description: 'Completaste 7 d√≠as seguidos' },
                { id: 3, name: 'Finanzas Pro', icon: 'üí∞', date: '2024-01-14', description: 'Completaste 5 tareas de finanzas' },
                { id: 4, name: 'Social Media', icon: 'üì±', date: '2024-01-15', description: 'Publicaste tu primer contenido' },
                { id: 5, name: 'Organizado', icon: 'üì¶', date: '2024-01-16', description: 'Organizaste tu inventario' }
            ];

            badgesGrid.innerHTML = badges.map(badge => `
                <div class="badge-card" data-badge-id="${badge.id}">
                    <div class="badge-card__icon">${badge.icon}</div>
                    <div class="badge-card__name">${badge.name}</div>
                    <div class="badge-card__date">Obtenida: ${formatDate(badge.date)}</div>
                    <button class="badge-card__share" onclick="openShareModal(${badge.id}, '${badge.icon}', '${badge.name}', '${badge.description}')">
                        Compartir üîó
                    </button>
                </div>
            `).join('');
        }

        function openShareModal(badgeId, icon, name, description) {
            document.getElementById('share-badge-icon').textContent = icon;
            document.getElementById('share-badge-name').textContent = name;
            document.getElementById('share-badge-desc').textContent = description;
            
            const modal = document.getElementById('share-badge-modal');
            modal.classList.add('modal--active');
            document.body.style.overflow = 'hidden';
        }

        function closeShareModal() {
            const modal = document.getElementById('share-badge-modal');
            modal.classList.remove('modal--active');
            document.body.style.overflow = '';
        }

        function shareToFacebook() {
            showToast('Abriendo Facebook para compartir...', 'info');
            closeShareModal();
        }

        function shareToInstagram() {
            showToast('Abriendo Instagram para compartir...', 'info');
            closeShareModal();
        }

        function shareToWhatsApp() {
            const text = encodeURIComponent('¬°Gan√© una nueva insignia en SUMAK! üèÜ');
            window.open('https://wa.me/?text=' + text, '_blank');
            closeShareModal();
        }

        function downloadBadgeImage() {
            showToast('Descargando imagen de la insignia...', 'success');
            closeShareModal();
        }

        // ========================================
        // US-004: MODO AUDIO
        // ========================================

        let audioPlaying = false;
        let audioInterval = null;
        let audioProgress = 0;

        function initAudioPlayer() {
            // Configuraci√≥n inicial del reproductor
        }

        function toggleAudio() {
            const playBtn = document.getElementById('audio-play-btn');
            const progressFill = document.getElementById('audio-progress-fill');
            const timeDisplay = document.getElementById('audio-time');

            if (audioPlaying) {
                // Pausar
                audioPlaying = false;
                clearInterval(audioInterval);
                playBtn.innerHTML = `<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><polygon points="5 3 19 12 5 21 5 3"/></svg>`;
            } else {
                // Reproducir
                audioPlaying = true;
                playBtn.innerHTML = `<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>`;
                
                audioInterval = setInterval(() => {
                    audioProgress += 1;
                    if (audioProgress >= 150) {
                        audioProgress = 0;
                        audioPlaying = false;
                        clearInterval(audioInterval);
                        playBtn.innerHTML = `<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><polygon points="5 3 19 12 5 21 5 3"/></svg>`;
                    }
                    
                    const percent = (audioProgress / 150) * 100;
                    progressFill.style.width = percent + '%';
                    
                    const currentSeconds = Math.floor(audioProgress);
                    const currentMinutes = Math.floor(currentSeconds / 60);
                    const remainingSeconds = currentSeconds % 60;
                    timeDisplay.textContent = `${currentMinutes}:${remainingSeconds.toString().padStart(2, '0')} / 2:30`;
                }, 1000);
            }
        }

        // ========================================
        // US-015: SUBIR EVIDENCIA CON PREVIEW
        // ========================================

        function initUploadArea() {
            const uploadArea = document.getElementById('upload-area');
            const fileInput = document.getElementById('evidence-file-input');
            
            if (!uploadArea || !fileInput) return;

            uploadArea.addEventListener('click', () => fileInput.click());
            
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFileSelect(files[0]);
                }
            });
            
            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleFileSelect(e.target.files[0]);
                }
            });
        }

        function handleFileSelect(file) {
            const maxSize = 10 * 1024 * 1024; // 10MB
            const allowedTypes = ['image/jpeg', 'image/png', 'image/gif', 'video/mp4', 'application/pdf'];
            
            if (file.size > maxSize) {
                showToast('El archivo es muy grande. M√°ximo 10MB.', 'error');
                return;
            }
            
            if (!allowedTypes.includes(file.type)) {
                showToast('Formato no soportado. Usa JPG, PNG, PDF o MP4.', 'error');
                return;
            }
            
            // Mostrar preview
            const preview = document.getElementById('upload-preview');
            const previewImage = document.getElementById('preview-image');
            
            if (file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    previewImage.src = e.target.result;
                    preview.classList.add('has-file');
                };
                reader.readAsDataURL(file);
            } else {
                previewImage.src = '';
                preview.classList.add('has-file');
                previewImage.alt = file.name;
            }
        }

        function openUploadModal() {
            const modal = document.getElementById('upload-evidence-modal');
            modal.classList.add('modal--active');
            document.body.style.overflow = 'hidden';
        }

        function closeUploadModal() {
            const modal = document.getElementById('upload-evidence-modal');
            modal.classList.remove('modal--active');
            document.body.style.overflow = '';
            
            // Reset preview
            document.getElementById('upload-preview').classList.remove('has-file');
            document.getElementById('evidence-file-input').value = '';
        }

        function replaceFile() {
            document.getElementById('evidence-file-input').click();
        }

        function confirmUpload() {
            showToast('¬°Evidencia subida exitosamente! üìé', 'success');
            closeUploadModal();
        }

        // ========================================
        // US-023: CONTACTAR MENTOR
        // ========================================

        document.getElementById('send-mentor-message')?.addEventListener('click', sendMentorMessage);
        document.getElementById('send-mentor-message-full')?.addEventListener('click', sendMentorMessage);

        function sendMentorMessage() {
            const messageInput = document.getElementById('mentor-message') || document.getElementById('mentor-message-full');
            const message = messageInput?.value.trim();
            
            if (!message) {
                showToast('Escribe un mensaje para tu mentor', 'error');
                return;
            }
            
            showToast('Mensaje enviado a tu mentora. Respuesta estimada: 2-4 horas.', 'success');
            messageInput.value = '';
        }

        document.getElementById('attach-evidence-btn')?.addEventListener('click', openUploadModal);
        document.getElementById('attach-evidence-btn-full')?.addEventListener('click', openUploadModal);

        // ========================================
        // US-007: PERFIL P√öBLICO
        // ========================================

        document.getElementById('edit-profile-btn')?.addEventListener('click', () => {
            showToast('Abriendo editor de perfil...', 'info');
        });

        document.getElementById('download-qr-btn')?.addEventListener('click', () => {
            showToast('Descargando c√≥digo QR...', 'success');
        });

        document.getElementById('share-profile-btn')?.addEventListener('click', () => {
            const profileUrl = 'https://sumak.pe/perfil/mi-negocio';
            navigator.clipboard.writeText(profileUrl).then(() => {
                showToast('¬°Enlace copiado al portapapeles! üìã', 'success');
            }).catch(() => {
                showToast('Compartiendo perfil...', 'info');
            });
        });

        // ========================================
        // VER DETALLES DE TAREA
        // ========================================

        window.viewTaskDetails = function(taskId) {
            const modal = document.getElementById('task-detail-modal');
            document.getElementById('task-detail-title').textContent = 'Registrar ventas del d√≠a';
            document.getElementById('task-detail-content').innerHTML = `
                <p style="margin-bottom: var(--spacing-md);">
                    <strong>Objetivo:</strong> Aprende a llevar un registro diario de todas tus ventas para tener mejor control de tu negocio.
                </p>
                <p style="margin-bottom: var(--spacing-md);">
                    <strong>Pasos a seguir:</strong>
                </p>
                <ol style="margin-left: var(--spacing-md); margin-bottom: var(--spacing-md);">
                    <li>Anota cada venta que realices durante el d√≠a</li>
                    <li>Incluye: producto, cantidad, precio y m√©todo de pago</li>
                    <li>Al final del d√≠a, suma el total de ventas</li>
                    <li>Toma una foto de tu registro y s√∫bela como evidencia</li>
                </ol>
                <p style="color: var(--color-text-secondary); font-size: var(--font-size-small);">
                    üí° <strong>Tip:</strong> Puedes usar una libreta o la plantilla que te proporcionamos
                </p>
            `;
            
            modal.classList.add('modal--active');
            document.body.style.overflow = 'hidden';
        };

        function closeTaskDetailModal() {
            const modal = document.getElementById('task-detail-modal');
            modal.classList.remove('modal--active');
            document.body.style.overflow = '';
        }

        // ========================================
        // UTILIDADES
        // ========================================

        function getCategoryLabel(category) {
            const labels = {
                'finanzas': 'üí∞ Finanzas',
                'marketing': 'üì± Marketing',
                'ventas': 'üõçÔ∏è Ventas',
                'operaciones': '‚öôÔ∏è Operaciones'
            };
            return labels[category] || category;
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('es-PE', { day: 'numeric', month: 'short', year: 'numeric' });
        }

        // Cerrar modales al hacer clic en overlay
        document.querySelectorAll('.modal__overlay').forEach(overlay => {
            overlay.addEventListener('click', () => {
                overlay.closest('.modal').classList.remove('modal--active');
                document.body.style.overflow = '';
            });
        });
    </script>
</body>
</html>